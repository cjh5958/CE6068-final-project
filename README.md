# ğŸ§¬ ç™½è¡€ç—…åŸºå› è¡¨é”è³‡æ–™å¢å¼·å°ˆæ¡ˆ (Leukemia Gene Expression Data Augmentation)

## ğŸ“‹ å°ˆæ¡ˆæ¦‚è¿°

æœ¬å°ˆæ¡ˆæä¾›å®Œæ•´çš„æ¢ä»¶è®Šåˆ†è‡ªç·¨ç¢¼å™¨ (Conditional VAE, cVAE) è§£æ±ºæ–¹æ¡ˆï¼Œç”¨æ–¼ç™½è¡€ç—…åŸºå› è¡¨é”è³‡æ–™çš„è¨“ç·´å’Œç”Ÿæˆã€‚æ”¯æ´å¾é›¶é–‹å§‹è¨“ç·´æ¨¡å‹ï¼Œä»¥åŠä½¿ç”¨é è¨“ç·´æ¨¡å‹ç”Ÿæˆé«˜å“è³ªåˆæˆè³‡æ–™ã€‚

### ğŸ¯ ä¸»è¦åŠŸèƒ½
- **æ¨¡å‹è¨“ç·´**: å®Œæ•´çš„ cVAE è¨“ç·´æµç¨‹ï¼Œæ”¯æ´è‡ªè¨‚åƒæ•¸
- **è³‡æ–™ç”Ÿæˆ**: ä½¿ç”¨é è¨“ç·´æ¨¡å‹ç”Ÿæˆåˆæˆè³‡æ–™
- **å¤šé¡å‹æ”¯æ´**: æ”¯æ´ 5 ç¨®ç™½è¡€ç—…é¡å‹çš„è³‡æ–™ç”Ÿæˆ
- **æ ¼å¼å…¼å®¹**: ç”Ÿæˆè³‡æ–™å®Œå…¨åŒ¹é…åŸå§‹è³‡æ–™æ ¼å¼ï¼Œä¾¿æ–¼ä¸‹æ¸¸ä½¿ç”¨
- **éˆæ´»è¼¸å‡º**: æ”¯æ´ CSV å’Œ PKL æ ¼å¼
- **ğŸ†• è¦–è¦ºåŒ–åˆ†æ**: è‡ªå‹•ç”Ÿæˆè³‡æ–™åˆ†å¸ƒæª¢å®šåœ–è¡¨
- **ğŸ†• å“è³ªç›£æ§**: PCAã€t-SNEã€ç›¸é—œæ€§åˆ†æç­‰å¤šç¶­åº¦è©•ä¼°
- **ğŸ†• æ·±åº¦åˆ†æ**: å°ˆæ¥­çš„è³‡æ–™é›†åˆ†æå·¥å…·ï¼Œæ”¯æ´ PCAã€t-SNEã€UMAP ç­‰å¤šç¨®é™ç¶­æ–¹æ³•

### ğŸ§ª æ”¯æ´çš„ç™½è¡€ç—…é¡å‹
1. **AML** - æ€¥æ€§éª¨é«“æ€§ç™½è¡€ç—…
2. **Bone_Marrow** - éª¨é«“æ¨£æœ¬
3. **Bone_Marrow_CD34** - CD34+ éª¨é«“ç´°èƒ
4. **PB** - å‘¨é‚Šè¡€æ¶²
5. **PBSC_CD34** - CD34+ å‘¨é‚Šè¡€æ¶²å¹¹ç´°èƒ

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
CE6068-final-project/
â”œâ”€â”€ README.md                    # æœ¬æª”æ¡ˆ
â”œâ”€â”€ train_model.py               # æ¨¡å‹è¨“ç·´è…³æœ¬
â”œâ”€â”€ generate_data.py             # è³‡æ–™ç”Ÿæˆè…³æœ¬ (å«è¦–è¦ºåŒ–åˆ†æ)
â”œâ”€â”€ analyze_dataset.py           # ğŸ†• å°ˆæ¥­è³‡æ–™é›†åˆ†æå·¥å…·
â”œâ”€â”€ model_usage_guide.py         # Python API ä»‹é¢
â”œâ”€â”€ models/                      # è¨“ç·´å¥½çš„æ¨¡å‹
â”‚   â”œâ”€â”€ leukemia_cvae_model.pth  # ä¸»è¦ cVAE æ¨¡å‹æª”æ¡ˆ
â”‚   â”œâ”€â”€ best_cvae_model.pth      # æœ€ä½³é©—è­‰æ¨¡å‹
â”‚   â””â”€â”€ final_cvae_model.pth     # æœ€çµ‚è¨“ç·´æ¨¡å‹
â”œâ”€â”€ datasets/                    # è³‡æ–™æª”æ¡ˆ
â”‚   â”œâ”€â”€ raw_data.csv            # åŸå§‹è³‡æ–™é›†
â”‚   â”œâ”€â”€ scaler.pkl              # ç‰¹å¾µæ­£è¦åŒ–å™¨
â”‚   â”œâ”€â”€ label_encoder.pkl       # æ¨™ç±¤ç·¨ç¢¼å™¨
â”‚   â”œâ”€â”€ metadata.pkl            # è³‡æ–™å…ƒè³‡è¨Š (å«åŸºå› åç¨±)
â”‚   â”œâ”€â”€ generated_data_*.csv    # ğŸ†• ç”Ÿæˆçš„è³‡æ–™æª”æ¡ˆ
â”‚   â””â”€â”€ plots/                  # ğŸ†• åˆ†å¸ƒæª¢å®šåœ–è¡¨ç›®éŒ„
â”‚       â”œâ”€â”€ *_class_distribution.png     # é¡åˆ¥åˆ†å¸ƒåœ–
â”‚       â”œâ”€â”€ *_statistics_summary.png     # çµ±è¨ˆæ‘˜è¦åœ–
â”‚       â”œâ”€â”€ *_pca_analysis.png           # PCA åˆ†æåœ–
â”‚       â”œâ”€â”€ *_tsne_analysis.png          # t-SNE åˆ†æåœ–
â”‚       â”œâ”€â”€ *_umap_analysis.png          # ğŸ†• UMAP åˆ†æåœ–
â”‚       â”œâ”€â”€ *_correlation_analysis.png   # ç›¸é—œæ€§åˆ†æåœ–
â”‚       â””â”€â”€ [è³‡æ–™é›†åç¨±]_analysis/        # ğŸ†• å®Œæ•´åˆ†æçµæœç›®éŒ„
â”œâ”€â”€ training_logs/              # è¨“ç·´æ—¥èªŒ (è¨“ç·´å¾Œç”¢ç”Ÿ)
â””â”€â”€ [æ ¸å¿ƒç¨‹å¼ç¢¼æª”æ¡ˆ]
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### **ç’°å¢ƒè¨­ç½®**
```bash
# å»ºç«‹ä¸¦å•Ÿå‹•è™›æ“¬ç’°å¢ƒ (å»ºè­°)
python -m venv venv
# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

# å®‰è£ä¾è³´
pip install -r requirements.txt
```

### **æ–¹å¼ 1: æ¨¡å‹è¨“ç·´ (å¾é›¶é–‹å§‹)**

```bash
# åŸºæœ¬è¨“ç·´ (ä½¿ç”¨é è¨­åƒæ•¸)
python train_model.py

# å¿«é€Ÿè¨“ç·´ (è¼ƒå°‘epochsï¼Œé©åˆæ¸¬è©¦)
python train_model.py --epochs 10 --batch-size 4

# è‡ªè¨‚è¨“ç·´åƒæ•¸
python train_model.py --epochs 150 --batch-size 16 --learning-rate 5e-5

# ä½¿ç”¨GPUè¨“ç·´ (å¦‚æœå¯ç”¨)
python train_model.py --device cuda

# ä½¿ç”¨é…ç½®æª”æ¡ˆ
python train_model.py --config my_config.json
```

### **æ–¹å¼ 2: è³‡æ–™ç”Ÿæˆ (ä½¿ç”¨é è¨“ç·´æ¨¡å‹) ğŸ†•**

```bash
# ç”Ÿæˆå¹³è¡¡è³‡æ–™é›† (æ¨è–¦) - å«å®Œæ•´è¦–è¦ºåŒ–åˆ†æ
python generate_data.py --balanced --samples-per-class 50

# ç”Ÿæˆç‰¹å®šé¡å‹æ¨£æœ¬ - å«åˆ†å¸ƒæª¢å®šåœ–è¡¨
python generate_data.py --type AML --samples 100

# è‡ªè¨‚è¼¸å‡ºæª”åå’Œæ ¼å¼
python generate_data.py --type PB --samples 200 --format csv --output my_leukemia_data

# è·³éåœ–è¡¨ç”Ÿæˆ (ç´”è³‡æ–™ç”Ÿæˆ)
python generate_data.py --balanced --samples-per-class 30 --no-plots
```

### **æ–¹å¼ 3: ğŸ†• è³‡æ–™é›†æ·±åº¦åˆ†æ**

```bash
# å®Œæ•´åˆ†æ - PCAã€t-SNEã€UMAPã€ç›¸é—œæ€§ã€çµ±è¨ˆç‰¹æ€§
python analyze_dataset.py datasets/generated_data_20250602_201358.csv

# å¿«é€Ÿåˆ†æ (é™åˆ¶ç›¸é—œæ€§åˆ†æç‰¹å¾µæ•¸)
python analyze_dataset.py datasets/my_data.csv --max-corr-features 50

# è·³éè¨ˆç®—å¯†é›†çš„åˆ†æ
python analyze_dataset.py datasets/large_data.csv --skip-tsne --skip-correlation

# åˆ†æåŸå§‹è³‡æ–™é€²è¡Œæ¯”è¼ƒ
python analyze_dataset.py datasets/raw_data.csv
```

### **æ–¹å¼ 4: Python API**

```python
from model_usage_guide import LeukemiaCVAEGenerator

# åˆå§‹åŒ–ç”Ÿæˆå™¨
generator = LeukemiaCVAEGenerator()

# ç”Ÿæˆç‰¹å®šé¡å‹æ¨£æœ¬
aml_data = generator.quick_generate_and_save(
    leukemia_type='AML', 
    n_samples=100,
    save_format='both'
)

# ç”Ÿæˆå¹³è¡¡è³‡æ–™é›†
balanced_data = generator.quick_generate_balanced_and_save(
    samples_per_class=50,
    save_format='both'
)
```

## ğŸ“Š ğŸ†• å°ˆæ¥­è³‡æ–™åˆ†æåŠŸèƒ½

### **analyze_dataset.py åŠŸèƒ½æ¦‚è¦½**

æ–°å¢çš„å°ˆæ¥­åˆ†æå·¥å…·æä¾›å¤šç¶­åº¦çš„è³‡æ–™å“è³ªæª¢æ¸¬ï¼š

- **ğŸ” PCA ä¸»æˆåˆ†åˆ†æ**: é™ç¶­ã€è®Šç•°è§£é‡‹ã€é¡åˆ¥åˆ†é›¢åº¦è©•ä¼°
- **ğŸŒ€ t-SNE éç·šæ€§é™ç¶­**: æ¢ç´¢éç·šæ€§èšé›†çµæ§‹  
- **ğŸ—ºï¸ UMAP çµ±ä¸€æµå½¢é€¼è¿‘**: å¹³è¡¡å±€éƒ¨èˆ‡å…¨å±€çµæ§‹çš„ç¾ä»£é™ç¶­æ–¹æ³•
- **ğŸ”— ç›¸é—œæ€§åˆ†æ**: ç‰¹å¾µé–“ç›¸é—œæ€§ç†±åŠ›åœ–å’Œçµ±è¨ˆæ‘˜è¦
- **ğŸ“ˆ çµ±è¨ˆç‰¹æ€§åˆ†æ**: é¡åˆ¥åˆ†å¸ƒã€ç‰¹å¾µåˆ†å¸ƒã€å“è³ªè©•ä¼°
- **ğŸ“Š é™ç¶­æ–¹æ³•æ¯”è¼ƒ**: ä¸¦æ’æ¯”è¼ƒä¸åŒé™ç¶­æŠ€è¡“çš„æ•ˆæœ

### **åˆ†æè¼¸å‡ºçµæ§‹**
```
datasets/plots/
â””â”€â”€ [è³‡æ–™é›†åç¨±]_analysis/
    â”œâ”€â”€ pca_analysis.png              # PCA ä¸»æˆåˆ†åˆ†æåœ–
    â”œâ”€â”€ tsne_analysis.png             # t-SNE é™ç¶­åˆ†æåœ–
    â”œâ”€â”€ umap_analysis.png             # UMAP é™ç¶­åˆ†æåœ–
    â”œâ”€â”€ correlation_analysis.png      # ç‰¹å¾µç›¸é—œæ€§åˆ†æåœ–
    â”œâ”€â”€ statistical_analysis.png      # çµ±è¨ˆç‰¹æ€§åˆ†æåœ–
    â””â”€â”€ dimensionality_reduction_comparison.png  # é™ç¶­æ–¹æ³•æ¯”è¼ƒåœ–
```

### **å¸¸ç”¨åˆ†ææŒ‡ä»¤**
```bash
# 1. åŸºæœ¬å®Œæ•´åˆ†æ
python analyze_dataset.py datasets/generated_data.csv

# 2. æ•ˆèƒ½å„ªåŒ–åˆ†æ (æ¨è–¦ç”¨æ–¼å¤§å‹è³‡æ–™é›†)
python analyze_dataset.py datasets/large_data.csv --max-corr-features 50

# 3. æ¯”è¼ƒåŸå§‹ vs ç”Ÿæˆè³‡æ–™
python analyze_dataset.py datasets/raw_data.csv --output-dir comparison
python analyze_dataset.py datasets/generated_data.csv --output-dir comparison

# 4. è¼•é‡ç´šåˆ†æ (è·³éè¨ˆç®—å¯†é›†é …ç›®)
python analyze_dataset.py datasets/data.csv --skip-tsne --skip-correlation
```

## ğŸ“Š è©³ç´°è³‡æ–™åˆ†æå·¥å…·ä½¿ç”¨æŒ‡å—

### **ğŸ¨ åˆ†æåœ–è¡¨è©³è§£**

#### **1. PCA ä¸»æˆåˆ†åˆ†æ (`pca_analysis.png`)**
- **2D æ•£é»åœ–**ï¼šå„é¡åˆ¥åœ¨å‰å…©å€‹ä¸»æˆåˆ†ç©ºé–“çš„åˆ†å¸ƒ
- **è®Šç•°è§£é‡‹æ¯”ä¾‹**ï¼šå„ä¸»æˆåˆ†çš„è²¢ç»åº¦æŸ±ç‹€åœ–
- **ç´¯ç©è®Šç•°æ›²ç·š**ï¼šä¸»æˆåˆ†ç´¯ç©è§£é‡‹è®Šç•°è¶¨å‹¢
- **å“è³ªè©•ä¼°**ï¼šSilhouette Score å’Œé—œéµçµ±è¨ˆæŒ‡æ¨™

#### **2. t-SNE éç·šæ€§é™ç¶­ (`tsne_analysis.png`)**
- **2D æŠ•å½±**ï¼šæ¢ç´¢éç·šæ€§èšé›†æ¨¡å¼
- **å“è³ªè©•ä¼°**ï¼šèšé¡åˆ†é›¢åº¦è©•åˆ†
- **è‡ªå‹•æ¡æ¨£**ï¼šå¤§è³‡æ–™é›†è‡ªå‹•æ¡æ¨£ä»¥æå‡è¨ˆç®—æ•ˆç‡

#### **3. UMAP çµ±ä¸€æµå½¢é€¼è¿‘ (`umap_analysis.png`)**
- **2D æŠ•å½±**ï¼šä¿æŒå±€éƒ¨å’Œå…¨å±€çµæ§‹çš„é™ç¶­çµæœ
- **å“è³ªè©•ä¼°**ï¼šèšé¡å“è³ªè©•åˆ†
- **åƒæ•¸å±•ç¤º**ï¼šneighbors åƒæ•¸ç­‰è¨­å®šè³‡è¨Š

#### **4. ç›¸é—œæ€§åˆ†æ (`correlation_analysis.png`)**
- **ç›¸é—œæ€§ç†±åŠ›åœ–**ï¼šé«˜æ–¹å·®ç‰¹å¾µé–“çš„ç›¸é—œæ€§çŸ©é™£
- **ç›¸é—œä¿‚æ•¸åˆ†å¸ƒ**ï¼šæ•´é«”ç›¸é—œæ€§çµ±è¨ˆç›´æ–¹åœ–
- **é«˜ç›¸é—œç‰¹å¾µå°**ï¼šè­˜åˆ¥å†—é¤˜ç‰¹å¾µçš„æ•£é»åœ–
- **çµ±è¨ˆæ‘˜è¦**ï¼šè©³ç´°çš„ç›¸é—œæ€§çµ±è¨ˆå ±å‘Š

#### **5. çµ±è¨ˆç‰¹æ€§åˆ†æ (`statistical_analysis.png`)**
- **é¡åˆ¥åˆ†å¸ƒ**ï¼šå„ç™½è¡€ç—…é¡å‹çš„æ¨£æœ¬åˆ†å¸ƒæŸ±ç‹€åœ–
- **ç‰¹å¾µå¹³å‡å€¼åˆ†å¸ƒ**ï¼šåŸºå› è¡¨é”å¹³å‡å€¼çš„åˆ†å¸ƒç›´æ–¹åœ–
- **ç‰¹å¾µè®Šç•°æ€§**ï¼šåŸºå› è¡¨é”è®Šç•°åº¦çš„åˆ†å¸ƒç›´æ–¹åœ–
- **æ¨£æœ¬é–“è·é›¢**ï¼šæ­å¹¾é‡Œå¾—è·é›¢åˆ†å¸ƒåˆ†æ
- **é¡åˆ¥æ¯”è¼ƒ**ï¼šå„é¡åˆ¥ç‰¹å¾µå€¼çš„ç®±ç·šåœ–æ¯”è¼ƒ
- **å“è³ªæŒ‡æ¨™**ï¼šè³‡æ–™å®Œæ•´æ€§å’Œå¹³è¡¡æ€§è©•ä¼°

#### **6. é™ç¶­æ–¹æ³•æ¯”è¼ƒ (`dimensionality_reduction_comparison.png`)**
- **ä¸¦æ’æ¯”è¼ƒ**ï¼šPCAã€t-SNEã€UMAP çµæœçš„è¦–è¦ºå°æ¯”
- **èšé¡æ•ˆæœ**ï¼šä¸åŒæ–¹æ³•çš„é¡åˆ¥åˆ†é›¢æ•ˆæœ

### **ğŸ¨ ä½¿ç”¨æ¡ˆä¾‹**

#### **æ¡ˆä¾‹ 1: å¿«é€Ÿå“è³ªæª¢æ¸¬**
```bash
# å°æ–°ç”Ÿæˆçš„è³‡æ–™é›†é€²è¡Œå¿«é€Ÿå“è³ªæª¢æ¸¬
python analyze_dataset.py datasets/new_generated_data.csv --max-corr-features 30
```

#### **æ¡ˆä¾‹ 2: è©³ç´°ç ”ç©¶åˆ†æ**
```bash
# å®Œæ•´åˆ†æï¼ŒåŒ…å«æ‰€æœ‰é™ç¶­æ–¹æ³•å’Œè©³ç´°ç›¸é—œæ€§åˆ†æ
python analyze_dataset.py datasets/research_data.csv --max-corr-features 200
```

#### **æ¡ˆä¾‹ 3: è¼•é‡ç´šåˆ†æ**
```bash
# è·³éè¨ˆç®—å¯†é›†çš„åˆ†æï¼Œé©åˆå¤§å‹è³‡æ–™é›†
python analyze_dataset.py datasets/large_dataset.csv --skip-tsne --skip-correlation
```

#### **æ¡ˆä¾‹ 4: æ¯”è¼ƒä¸åŒè³‡æ–™é›†**
```bash
# åˆ†æå¤šå€‹è³‡æ–™é›†ä¸¦æ¯”è¼ƒçµæœ
python analyze_dataset.py datasets/original_data.csv --output-dir comparison_study
python analyze_dataset.py datasets/generated_data.csv --output-dir comparison_study
python analyze_dataset.py datasets/augmented_data.csv --output-dir comparison_study
```

### **ğŸ“ˆ çµæœè§£è®€æŒ‡å—**

#### **PCA åˆ†æè§£è®€**
- **å‰2å€‹ä¸»æˆåˆ†è§£é‡‹è®Šç•° > 50%**ï¼šè³‡æ–™å…·æœ‰è‰¯å¥½çš„ä½ç¶­è¡¨ç¤º
- **å‰2å€‹ä¸»æˆåˆ†è§£é‡‹è®Šç•° < 30%**ï¼šè€ƒæ…®å¢åŠ ä¸»æˆåˆ†æ•¸é‡æˆ–ä½¿ç”¨éç·šæ€§æ–¹æ³•
- **é«˜ Silhouette Score (>0.5)**ï¼šé¡åˆ¥åœ¨é™ç¶­ç©ºé–“ä¸­åˆ†é›¢è‰¯å¥½

#### **t-SNE vs UMAP æ¯”è¼ƒ**
- **t-SNE æ“…é•·**ï¼šç™¼ç¾å±€éƒ¨èšé›†çµæ§‹ï¼Œçªå‡ºé¡åˆ¥å…§çš„ç´°å¾®å·®ç•°
- **UMAP æ“…é•·**ï¼šä¿æŒå…¨å±€çµæ§‹ï¼Œè¨ˆç®—æ•ˆç‡æ›´é«˜ï¼Œåƒæ•¸èª¿æ•´æ›´éˆæ´»
- **å»ºè­°**ï¼šå…©ç¨®æ–¹æ³•çµåˆä½¿ç”¨ï¼Œæä¾›äº’è£œçš„è¦–è§’

#### **ç›¸é—œæ€§åˆ†ææŒ‡å°**
- **é«˜ç›¸é—œç‰¹å¾µå°æ•¸é‡å¤š**ï¼šè€ƒæ…®ç‰¹å¾µé¸æ“‡æˆ–é™ç¶­ä»¥æ¸›å°‘å†—é¤˜
- **å¹³å‡ç›¸é—œä¿‚æ•¸æ¥è¿‘0**ï¼šç‰¹å¾µç¨ç«‹æ€§è‰¯å¥½
- **ç›¸é—œä¿‚æ•¸åˆ†å¸ƒåå‘æ¥µå€¼**ï¼šå¯èƒ½å­˜åœ¨å¼·ç›¸é—œæˆ–å¼·åç›¸é—œçš„åŸºå› ç¾¤çµ„

#### **çµ±è¨ˆç‰¹æ€§è©•ä¼°**
- **é¡åˆ¥å¹³è¡¡åº¦ > 0.8**ï¼šè³‡æ–™é›†å¹³è¡¡æ€§è‰¯å¥½
- **æ¨£æœ¬é–“è·é›¢åˆ†å¸ƒæ­£å¸¸**ï¼šç„¡æ˜é¡¯é›¢ç¾¤å€¼æˆ–æ•¸æ“šå“è³ªå•é¡Œ
- **ç‰¹å¾µè®Šç•°æ€§é©ä¸­**ï¼šåŸºå› è¡¨é”å·®ç•°åˆç†ï¼Œæœ‰åˆ©æ–¼åˆ†é¡

### **ğŸ’¡ æœ€ä½³å¯¦è¸å»ºè­°**

#### **åˆ†æå·¥ä½œæµç¨‹**
1. **åˆæ­¥æª¢æ¸¬**ï¼šä½¿ç”¨é è¨­åƒæ•¸å¿«é€Ÿåˆ†æ
2. **å“è³ªè©•ä¼°**ï¼šæª¢æŸ¥ PCA è§£é‡‹è®Šç•°å’Œ Silhouette Score
3. **æ·±å…¥åˆ†æ**ï¼šæ ¹æ“šåˆæ­¥çµæœèª¿æ•´åƒæ•¸é€²è¡Œè©³ç´°åˆ†æ
4. **æ¯”è¼ƒç ”ç©¶**ï¼šå°æ¯”ä¸åŒè³‡æ–™é›†çš„åˆ†æçµæœ

#### **æ•ˆèƒ½å„ªåŒ–**
- **å¤§å‹è³‡æ–™é›†**ï¼šä½¿ç”¨ `--max-corr-features 50` é™åˆ¶ç›¸é—œæ€§åˆ†æç¯„åœ
- **å¿«é€Ÿæª¢æ¸¬**ï¼šè·³ééå¿…è¦åˆ†æ `--skip-tsne --skip-correlation`
- **æ‰¹æ¬¡è™•ç†**ï¼šç·¨å¯«è…³æœ¬å°å¤šå€‹è³‡æ–™é›†æ‰¹æ¬¡åˆ†æ

#### **çµæœæ‡‰ç”¨**
- **æ¨¡å‹é¸æ“‡**ï¼šæ ¹æ“šé™ç¶­çµæœé¸æ“‡åˆé©çš„æ©Ÿå™¨å­¸ç¿’æ¨¡å‹
- **ç‰¹å¾µå·¥ç¨‹**ï¼šåˆ©ç”¨ç›¸é—œæ€§åˆ†æçµæœé€²è¡Œç‰¹å¾µé¸æ“‡
- **è³‡æ–™å¢å¼·è©•ä¼°**ï¼šæ¯”è¼ƒåŸå§‹è³‡æ–™å’Œç”Ÿæˆè³‡æ–™çš„åˆ†å¸ƒç‰¹æ€§

## ğŸ“Š è¼¸å‡ºæ ¼å¼

### **ğŸ†• è¦–è¦ºåŒ–åˆ†æåœ–è¡¨**
æ¯æ¬¡ç”Ÿæˆè³‡æ–™æ™‚ï¼Œç³»çµ±æœƒè‡ªå‹•å‰µå»ºä»¥ä¸‹åˆ†æåœ–è¡¨ï¼š

1. **é¡åˆ¥åˆ†å¸ƒåœ“é¤…åœ–** - é¡¯ç¤ºå„ç™½è¡€ç—…é¡å‹çš„æ¨£æœ¬åˆ†å¸ƒ
2. **çµ±è¨ˆæ‘˜è¦åœ–** - åŒ…å«æ¨£æœ¬å‡å€¼ã€è®Šç•°æ•¸ã€åŸºå› è¡¨é”åˆ†å¸ƒç­‰
3. **PCAåˆ†æåœ–** - ä¸»æˆåˆ†åˆ†æé™ç¶­å¯è¦–åŒ–ï¼Œé¡¯ç¤ºé¡åˆ¥èšé›†æƒ…æ³
4. **t-SNEåˆ†æåœ–** - éç·šæ€§é™ç¶­å¯è¦–åŒ– (æ¨£æœ¬æ•¸ â‰¤ 1000 æ™‚)
5. **ğŸ†• UMAPåˆ†æåœ–** - çµ±ä¸€æµå½¢é€¼è¿‘èˆ‡æŠ•å½±é™ç¶­
6. **ç›¸é—œæ€§ç†±åŠ›åœ–** - å‰50å€‹åŸºå› çš„è¡¨é”ç›¸é—œæ€§çŸ©é™£

### **CSV æ ¼å¼ (å®Œå…¨åŒ¹é…åŸå§‹è³‡æ–™)**
ç”Ÿæˆçš„è³‡æ–™å°‡å®Œå…¨åŒ¹é…åŸå§‹è¼¸å…¥æ ¼å¼ï¼ŒåŒ…æ‹¬ï¼š
```csv
samples,type,1007_s_at,1053_at,117_at,121_at,1255_g_at,1294_at,1316_at,1320_at,...
1000,AML,7.234,8.456,6.123,9.789,4.567,7.890,8.234,7.567,...
1001,AML,7.456,8.234,6.345,9.456,4.789,7.567,8.456,7.789,...
1002,Bone_Marrow,6.789,7.123,5.890,8.234,4.123,6.789,7.123,6.456,...
...
```

### **ç‰¹é»**
- âœ… **samplesæ¬„ä½**: è‡ªå‹•ç”Ÿæˆæ¨£æœ¬ID (å¾1000é–‹å§‹)
- âœ… **typeæ¬„ä½**: ä½¿ç”¨åŸå§‹ç™½è¡€ç—…é¡å‹åç¨±
- âœ… **åŸºå› æ¬„ä½**: ä½¿ç”¨çœŸå¯¦åŸºå› ID (å¦‚ 1007_s_at, 1053_at...)
- âœ… **æ¬„ä½é †åº**: å®Œå…¨åŒ¹é…åŸå§‹è³‡æ–™æ¬„ä½é †åº
- âœ… **ç›´æ¥ä½¿ç”¨**: å¯ç›´æ¥ç”¨æ–¼ä¸‹æ¸¸åˆ†æï¼Œç„¡éœ€é¡å¤–è™•ç†
- âœ… **ğŸ†• å“è³ªä¿è­‰**: é™„å¸¶è¦–è¦ºåŒ–åˆ†æç¢ºä¿è³‡æ–™å“è³ª

### **æª”æ¡ˆå‘½åè¦å‰‡ ğŸ†•**
```
datasets/
â”œâ”€â”€ generated_data_20250602_143022.csv                    # å¹³è¡¡è³‡æ–™é›†
â”œâ”€â”€ generated_data_complete_20250602_143022.pkl           # å®Œæ•´PKLæ ¼å¼
â”œâ”€â”€ generated_data_aml_20250602_143530.csv               # ç‰¹å®šé¡å‹è³‡æ–™
â”œâ”€â”€ generated_data_aml_complete_20250602_143530.pkl      # ç‰¹å®šé¡å‹PKL
â””â”€â”€ plots/
    â”œâ”€â”€ generated_data_class_distribution.png             # é¡åˆ¥åˆ†å¸ƒåœ–
    â”œâ”€â”€ generated_data_statistics_summary.png             # çµ±è¨ˆæ‘˜è¦
    â”œâ”€â”€ generated_data_pca_analysis.png                   # PCAåˆ†æ
    â”œâ”€â”€ generated_data_tsne_analysis.png                  # t-SNEåˆ†æ
    â”œâ”€â”€ generated_data_umap_analysis.png                  # ğŸ†• UMAPåˆ†æ
    â”œâ”€â”€ generated_data_correlation_heatmap.png            # ç›¸é—œæ€§åˆ†æ
    â””â”€â”€ [è³‡æ–™é›†åç¨±]_analysis/                             # ğŸ†• å®Œæ•´åˆ†æçµæœ
        â”œâ”€â”€ pca_analysis.png
        â”œâ”€â”€ tsne_analysis.png
        â”œâ”€â”€ umap_analysis.png
        â”œâ”€â”€ correlation_analysis.png
        â”œâ”€â”€ statistical_analysis.png
        â””â”€â”€ dimensionality_reduction_comparison.png
```

### **PKL æ ¼å¼**
```python
{
    'features': numpy.ndarray,      # åŸºå› è¡¨é”ç‰¹å¾µ (n_samples, 22283)
    'labels': numpy.ndarray,        # æ•¸å€¼æ¨™ç±¤ 
    'class_names': list,            # é¡åˆ¥åç¨±
    'generation_time': str,         # ç”Ÿæˆæ™‚é–“
    'metadata': {
        'gene_names': list,         # çœŸå¯¦åŸºå› åç¨±
        'total_genes': int,         # åŸºå› ç¸½æ•¸
        'available_classes': list   # å¯ç”¨é¡åˆ¥
    }
}
```

## âš™ï¸ ç³»çµ±éœ€æ±‚

### **è»Ÿé«”éœ€æ±‚**
- Python 3.8+
- PyTorch 2.0+
- å…¶ä»–ä¾è³´: pandas, numpy, scikit-learn, matplotlib, seaborn, umap-learn

### **ç¡¬é«”éœ€æ±‚**
- **CPU**: ç¾ä»£å¤šæ ¸å¿ƒè™•ç†å™¨
- **RAM**: å»ºè­° 8GB ä»¥ä¸Š (è¨“ç·´æ™‚éœ€è¦ 16GB+)
- **å„²å­˜ç©ºé–“**: 5GB å¯ç”¨ç©ºé–“
- **GPU**: å¯é¸ï¼ŒCUDA æ”¯æ´çš„é¡¯å¡å¯å¤§å¹…åŠ é€Ÿè¨“ç·´

## ğŸ”§ æ•…éšœæ’é™¤

### **è¨“ç·´å•é¡Œ**

#### ğŸ”´ è¨˜æ†¶é«”ä¸è¶³
```bash
# æ¸›å°‘æ‰¹æ¬¡å¤§å°
python train_model.py --batch-size 4

# ä½¿ç”¨è¼ƒå°çš„æ¨¡å‹
python train_model.py --latent-dim 128
```

#### ğŸ”´ è¨“ç·´éæ…¢
```bash
# ä½¿ç”¨GPU (å¦‚æœå¯ç”¨)
python train_model.py --device cuda

# æ¸›å°‘è¨“ç·´é€±æœŸ
python train_model.py --epochs 50
```

### **ç”Ÿæˆå•é¡Œ**

#### ğŸ”´ æ¨¡å‹æª”æ¡ˆéºå¤±
```bash
# å…ˆè¨“ç·´æ¨¡å‹
python train_model.py

# ç„¶å¾Œç”Ÿæˆè³‡æ–™
python generate_data.py --balanced
```

#### ğŸ”´ ç”Ÿæˆå¤±æ•—
ç¢ºä¿ä»¥ä¸‹æª”æ¡ˆå­˜åœ¨ï¼š
- `models/leukemia_cvae_model.pth`
- `datasets/scaler.pkl`
- `datasets/metadata.pkl` (å«åŸºå› åç¨±)

#### ğŸ”´ ğŸ†• åœ–è¡¨ç”Ÿæˆå¤±æ•—
```bash
# è·³éåœ–è¡¨ç”Ÿæˆï¼Œåƒ…ç”Ÿæˆè³‡æ–™
python generate_data.py --balanced --samples-per-class 50 --no-plots

# æª¢æŸ¥æ˜¯å¦å®‰è£äº†è¦–è¦ºåŒ–ä¾è³´
pip install matplotlib seaborn umap-learn
```

### **ğŸ†• åˆ†æå•é¡Œ**

#### ğŸ”´ åˆ†æå·¥å…·è¨˜æ†¶é«”ä¸è¶³
```bash
# æ¸›å°‘ç›¸é—œæ€§åˆ†æçš„ç‰¹å¾µæ•¸é‡
python analyze_dataset.py dataset.csv --max-corr-features 50

# è·³éè¨ˆç®—å¯†é›†çš„åˆ†æ
python analyze_dataset.py dataset.csv --skip-correlation --skip-tsne
```

#### ğŸ”´ UMAP æœªå®‰è£
```bash
# å®‰è£ UMAP (å·²åŒ…å«åœ¨ requirements.txt ä¸­)
pip install umap-learn

# æˆ–è·³é UMAP åˆ†æ
python analyze_dataset.py dataset.csv --skip-umap
```

#### ğŸ”´ è¨ˆç®—æ™‚é–“éé•·
```bash
# t-SNE è‡ªå‹•å°å¤§è³‡æ–™é›†æ¡æ¨£ï¼Œæˆ–å¯æ‰‹å‹•è·³é
python analyze_dataset.py dataset.csv --skip-tsne

# æ¸›å°‘ç›¸é—œæ€§åˆ†æè² æ“”
python analyze_dataset.py dataset.csv --max-corr-features 30
```

#### ğŸ”´ è³‡æ–™æ ¼å¼å•é¡Œ
- **CSV æ ¼å¼**ï¼šå¿…é ˆåŒ…å« `type` æ¬„ä½è¡¨ç¤ºé¡åˆ¥æ¨™ç±¤
- **PKL æ ¼å¼**ï¼šå¿…é ˆåŒ…å« `features`ã€`labels` éµå€¼
- **ç·¨ç¢¼å•é¡Œ**ï¼šç¢ºä¿æª”æ¡ˆä½¿ç”¨ UTF-8 ç·¨ç¢¼

### **ç’°å¢ƒå•é¡Œ**

#### ğŸ”´ ä¾è³´å¥—ä»¶å•é¡Œ
```bash
# å®‰è£å®Œæ•´ä¾è³´
pip install -r requirements.txt

# æˆ–ä½¿ç”¨conda
conda install pytorch pandas numpy scikit-learn matplotlib seaborn
conda install -c conda-forge umap-learn
```

## ğŸ“ˆ ä½¿ç”¨æµç¨‹å»ºè­°

### **æ–°ç”¨æˆ¶ (å¾é›¶é–‹å§‹)**
1. **æº–å‚™ç’°å¢ƒ**: å»ºç«‹è™›æ“¬ç’°å¢ƒä¸¦å®‰è£ä¾è³´
2. **æº–å‚™è³‡æ–™**: ç¢ºä¿ `datasets/raw_data.csv` å­˜åœ¨
3. **å¿«é€Ÿè¨“ç·´**: `python train_model.py --epochs 10`
4. **ç”Ÿæˆä¸¦åˆ†æ**: `python generate_data.py --balanced --samples-per-class 20`
5. **ğŸ†• æ·±åº¦åˆ†æ**: `python analyze_dataset.py datasets/generated_data_*.csv`
6. **æª¢æŸ¥å“è³ª**: æŸ¥çœ‹ `datasets/plots/` ä¸­çš„åˆ†æåœ–è¡¨
7. **æ­£å¼è¨“ç·´**: `python train_model.py` (ä½¿ç”¨å®Œæ•´åƒæ•¸)

### **ç¾æœ‰æ¨¡å‹ç”¨æˆ¶**
1. **æª¢æŸ¥æ¨¡å‹**: ç¢ºä¿æ¨¡å‹å’Œmetadataæª”æ¡ˆå­˜åœ¨
2. **ç›´æ¥ç”Ÿæˆ**: `python generate_data.py --type AML --samples 100`
3. **ğŸ†• å°ˆæ¥­åˆ†æ**: `python analyze_dataset.py datasets/generated_data.csv`
4. **å“è³ªè©•ä¼°**: æª¢æŸ¥è‡ªå‹•ç”Ÿæˆçš„ PCAã€t-SNEã€UMAP ç­‰åˆ†æåœ–è¡¨
5. **ä¸‹æ¸¸ä½¿ç”¨**: ç”Ÿæˆçš„è³‡æ–™å¯ç›´æ¥ç”¨æ–¼æ©Ÿå™¨å­¸ç¿’æ¨¡å‹

### **ğŸ†• è³‡æ–™å“è³ªè©•ä¼°å·¥ä½œæµç¨‹**
1. **ç”Ÿæˆè³‡æ–™**: ä½¿ç”¨ `generate_data.py` ç”Ÿæˆåˆæˆè³‡æ–™
2. **å…¨é¢åˆ†æ**: ä½¿ç”¨ `analyze_dataset.py` é€²è¡Œæ·±åº¦åˆ†æ
3. **æª¢æŸ¥åˆ†å¸ƒ**: æŸ¥çœ‹é¡åˆ¥åˆ†å¸ƒå’Œçµ±è¨ˆç‰¹æ€§åœ–è¡¨
4. **è©•ä¼°é™ç¶­**: æ¯”è¼ƒ PCAã€t-SNEã€UMAP çš„èšé¡æ•ˆæœ
5. **ç›¸é—œæ€§æª¢æŸ¥**: åˆ†æåŸºå› è¡¨é”ç›¸é—œæ€§æ˜¯å¦åˆç†
6. **æ¯”è¼ƒç ”ç©¶**: å°æ¯”åŸå§‹è³‡æ–™å’Œç”Ÿæˆè³‡æ–™çš„åˆ†æçµæœ

### **å”ä½œé–‹ç™¼**
1. **ç’°å¢ƒéš”é›¢**: æ¯å€‹é–‹ç™¼è€…å»ºç«‹è‡ªå·±çš„è™›æ“¬ç’°å¢ƒ
2. **ç‰ˆæœ¬æ§åˆ¶**: åƒ…è¿½è¹¤ç¨‹å¼ç¢¼ï¼Œä¸åŒ…å«æ¨¡å‹æª”æ¡ˆå’Œè™›æ“¬ç’°å¢ƒ
3. **è³‡æ–™æ¨™æº–**: çµ±ä¸€ä½¿ç”¨åŸå§‹è³‡æ–™æ ¼å¼é€²è¡Œäº¤æ›
4. **ğŸ†• å“è³ªæ¨™æº–**: ä½¿ç”¨å°ˆæ¥­åˆ†æå·¥å…·å»ºç«‹è³‡æ–™å“è³ªè©•ä¼°æ¨™æº–

## ğŸ“š æŠ€è¡“ç´°ç¯€

### **æ¨¡å‹æ¶æ§‹**
- **é¡å‹**: æ¢ä»¶è®Šåˆ†è‡ªç·¨ç¢¼å™¨ (Conditional VAE)
- **æ½›åœ¨ç©ºé–“ç¶­åº¦**: 256 (å¯èª¿æ•´)
- **ç·¨ç¢¼å™¨**: [2048, 1024, 512, 256] éš±è—å±¤
- **è§£ç¢¼å™¨**: [256, 512, 1024, 2048] éš±è—å±¤
- **æ¢ä»¶ç¶­åº¦**: 5 (å°æ‡‰ 5 ç¨®ç™½è¡€ç—…é¡å‹)

### **è¨“ç·´è³‡æ–™**
- **åŸå§‹æ¨£æœ¬**: 64 å€‹æ¨£æœ¬ Ã— 22,283 å€‹åŸºå› 
- **è³‡æ–™ä¾†æº**: Kaggle ç™½è¡€ç—…åŸºå› è¡¨é”è³‡æ–™é›†
- **å‰è™•ç†**: æ¨™æº–åŒ– + æ¨™ç±¤ç·¨ç¢¼
- **è³‡æ–™åˆ†å‰²**: è¨“ç·´/é©—è­‰/æ¸¬è©¦ = 73%/12%/15%

### **ğŸ†• å°ˆæ¥­åˆ†ææŠ€è¡“**
- **PCA**: ä¸»æˆåˆ†åˆ†æï¼Œä¿ç•™å‰2å€‹ä¸»æˆåˆ†ç”¨æ–¼2Då¯è¦–åŒ–
- **t-SNE**: éç·šæ€§é™ç¶­æŠ€è¡“ï¼Œé©åˆç™¼ç¾éç·šæ€§èšé›†æ¨¡å¼
- **UMAP**: çµ±ä¸€æµå½¢é€¼è¿‘èˆ‡æŠ•å½±ï¼Œå¹³è¡¡å±€éƒ¨å’Œå…¨å±€çµæ§‹
- **ç›¸é—œæ€§åˆ†æ**: ä½¿ç”¨çš®çˆ¾æ£®ç›¸é—œä¿‚æ•¸è¨ˆç®—åŸºå› é–“ç›¸é—œæ€§
- **çµ±è¨ˆæ‘˜è¦**: åŒ…å«å‡å€¼ã€è®Šç•°æ•¸ã€åˆ†å¸ƒç›´æ–¹åœ–ç­‰
- **Silhouette Score**: è©•ä¼°èšé¡å“è³ªçš„å®¢è§€æŒ‡æ¨™

### **æ ¼å¼å…¼å®¹æ€§**
- **å®Œå…¨åŒ¹é…**: ç”Ÿæˆè³‡æ–™èˆ‡åŸå§‹è³‡æ–™æ ¼å¼100%ç›¸åŒ
- **åŸºå› åç¨±**: ä¿ç•™çœŸå¯¦åŸºå› æ¢é‡ID (å¦‚ 1007_s_at)
- **æ¨£æœ¬ç·¨è™Ÿ**: è‡ªå‹•ç”Ÿæˆä¸è¡çªçš„æ¨£æœ¬ID
- **å³ç”¨æ€§**: ç„¡éœ€é¡å¤–è™•ç†å³å¯ç”¨æ–¼ä¸‹æ¸¸åˆ†æ

## ğŸ“ æ”¯æ´èˆ‡é€²éšä½¿ç”¨

### **å‘½ä»¤åˆ—åƒæ•¸å®Œæ•´åˆ—è¡¨**

#### **è¨“ç·´è…³æœ¬ (train_model.py)**
```bash
--config          # é…ç½®æª”æ¡ˆè·¯å¾‘
--epochs          # è¨“ç·´é€±æœŸæ•¸ (é è¨­: 100)
--batch-size      # æ‰¹æ¬¡å¤§å° (é è¨­: 8)
--learning-rate   # å­¸ç¿’ç‡ (é è¨­: 1e-4)
--latent-dim      # æ½›åœ¨ç©ºé–“ç¶­åº¦ (é è¨­: 256)
--device          # é‹ç®—è£ç½® (é è¨­: auto)
```

#### **ç”Ÿæˆè…³æœ¬ (generate_data.py) ğŸ†•**
```bash
--type               # ç™½è¡€ç—…é¡å‹
--balanced           # ç”Ÿæˆå¹³è¡¡è³‡æ–™é›†
--samples            # æ¨£æœ¬æ•¸é‡ (å–®ä¸€é¡å‹)
--samples-per-class  # æ¯é¡æ¨£æœ¬æ•¸ (å¹³è¡¡è³‡æ–™é›†)
--format             # è¼¸å‡ºæ ¼å¼ (csv/pkl/both)
--output             # è‡ªè¨‚æª”åå‰ç¶´ (é è¨­: generated_data)
--output-dir         # è¼¸å‡ºç›®éŒ„
--no-plots           # ğŸ†• è·³éè¦–è¦ºåŒ–åœ–è¡¨ç”Ÿæˆ
```

#### **ğŸ†• åˆ†æè…³æœ¬ (analyze_dataset.py)**
```bash
python analyze_dataset.py <dataset_path> [é¸é …]

å¿…è¦åƒæ•¸:
  dataset_path              è³‡æ–™é›†æª”æ¡ˆè·¯å¾‘ (.csv æˆ– .pkl)

å¯é¸åƒæ•¸:
  --output-dir DIR          è¼¸å‡ºç›®éŒ„ (é è¨­: datasets/plots)
  --skip-pca               è·³é PCA åˆ†æ
  --skip-tsne              è·³é t-SNE åˆ†æ
  --skip-umap              è·³é UMAP åˆ†æ
  --skip-correlation       è·³éç›¸é—œæ€§åˆ†æ
  --skip-statistics        è·³éçµ±è¨ˆåˆ†æ
  --max-corr-features N    ç›¸é—œæ€§åˆ†ææœ€å¤§ç‰¹å¾µæ•¸ (é è¨­: 100)
```

### **Python API é€²éšåŠŸèƒ½**
```python
# æª¢æŸ¥æ ¼å¼å…¼å®¹æ€§
generator = LeukemiaCVAEGenerator()
print(f"Gene names loaded: {len(generator.gene_names)}")
print(f"First 5 genes: {generator.gene_names[:5]}")

# æ‰¹æ¬¡ç”Ÿæˆå¤šç¨®é¡å‹
for leukemia_type in ['AML', 'PB', 'Bone_Marrow']:
    data = generator.generate_samples(leukemia_type, n_samples=50)
    # è³‡æ–™æ ¼å¼èˆ‡åŸå§‹è³‡æ–™å®Œå…¨ç›¸åŒ
```

### **ğŸ†• å°ˆæ¥­åˆ†æé€²éšç”¨æ³•**
```python
from analyze_dataset import DatasetAnalyzer

# åˆå§‹åŒ–åˆ†æå™¨
analyzer = DatasetAnalyzer(output_base_dir='custom_analysis')

# è‡ªè¨‚åˆ†æåƒæ•¸
analyzer.tsne_params = {'n_components': 2, 'perplexity': 50}
analyzer.umap_params = {'n_neighbors': 30, 'min_dist': 0.1}

# åŸ·è¡Œåˆ†æ
output_dir = analyzer.analyze_dataset(
    'datasets/my_data.csv',
    include_umap=True,
    max_correlation_features=200
)
```

### **ğŸ†• çµæœè§£è®€æŒ‡å—**
- **PCA å‰2å€‹ä¸»æˆåˆ†è§£é‡‹è®Šç•° > 50%**: è³‡æ–™å…·æœ‰è‰¯å¥½çš„ä½ç¶­è¡¨ç¤º
- **é«˜ Silhouette Score (>0.5)**: é¡åˆ¥åœ¨é™ç¶­ç©ºé–“ä¸­åˆ†é›¢è‰¯å¥½
- **UMAP vs t-SNE**: UMAP ä¿æŒå…¨å±€çµæ§‹ï¼Œt-SNE çªå‡ºå±€éƒ¨èšé›†
- **é«˜ç›¸é—œç‰¹å¾µå°æ•¸é‡å¤š**: è€ƒæ…®ç‰¹å¾µé¸æ“‡ä»¥æ¸›å°‘å†—é¤˜

## ğŸ“š ç›¸é—œæ–‡ä»¶

- **è¨“ç·´æ—¥èªŒ**: æŸ¥çœ‹ `training_logs/` ç›®éŒ„ä¸­çš„è¨“ç·´è¨˜éŒ„
- **æ¨¡å‹æ–‡ä»¶**: è©³ç´°æŠ€è¡“è¦æ ¼è«‹åƒè€ƒåŸå§‹ç¢¼è¨»è§£